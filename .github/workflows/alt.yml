name: "Ci pipeline"

on:  
  push:
    branches: [main]

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: ["ubuntu-latest", "windows-latest"]
        version: [8.0, 9.0]

    steps:
      - name: "Action checkout build"
        run: |
          echo "${{ toJSON(github.user) }} requested push to main"
          
      - name:  "code checkout"
        uses: actions/checkout@v5
        
      - name: "setup dotnet"
        uses: actions/setup-dotnet@v5
        with: 
          dotnet-version: ${{ matrix.version }}
      
      - name: "branch"
        run: |
          echo "build started"
          dotnet build --configuration release
          

      - name: "Execute Test"
        if: success()
        run: |
          dotnet restore
          dotnet test --no-build

      - name: "Build Failed"
        if: failure()
        run: |
          echo "Build failed with the following errors (promise i'll capture the ouput eventually)"
